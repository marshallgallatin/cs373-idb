{% extends "layout.html" %}
{% block scripts %}
	<style>
	.glyphicon-ok {
		color: green;
	}
	tr {
		cursor: hand;
		cursor: pointer;
	}
	.table td.fit, 
	.table th.fit {
		white-space: nowrap;
		width: 1%;
	}
	</style>
	<script>
		$(document).ready(function(){
			$("table tr").click(function(event){
				$glyph = $(this).children().find(".glyphicon");
				$glyph.toggleClass("glyphicon-minus glyphicon-ok");
				$textD = $(this).children().eq(1);
				$nextRow = $(this).next().children().eq(1);
				
				if ($textD.hasClass("text-muted")) {
					//Backward
					if ($(this).prev().prop("tagName") == undefined || $(this).prev().children().eq(1).hasClass("text-muted"))
						$textD.addClass("info");
					
					if (!$nextRow.hasClass("text-muted"))
						$nextRow.removeClass("info");
				} else {
					//Forward
					$textD.removeClass("info");
					
					if (!$nextRow.hasClass("text-muted"))
						$nextRow.toggleClass("info");
				}
				$textD.toggleClass("text-muted");
			});
			$("table tr").hover(function(){
				$('this').css('cursor', 'pointer');
			});
		});
		
		angular.module('mbApp', []).controller('mbCtrl', function($scope, $http) {
			$scope.getData = function () {
				$http.get("test/r").then(function (transmit) {
					$scope.data = transmit.data;
					$scope.data.instructions = $scope.data.instructions.replace("<ol><li>", "").replace("</li></ol>", "").split("</li><li>");
					$scope.halfI = Math.floor($scope.data.ingredients.length / 2);
				});
			}
			$(function() {
				$scope.getData();
			});
		});
	</script>
{% endblock scripts %}

{% block title %}
{{ title }}
{% endblock title %}

{% block content %}
<div ng-app="mbApp" ng-controller="mbCtrl">
	<div class="row">
		<div class="col-xs-12 col-sm-6 col-lg-6">
			<h1>{{ '{{data.title}}' }}</h1>
			{{ '{{data}}' }}
			{{ '{{halfI}}' }}
		</div>
		<div style="padding-top:10px" class="col-xs-12 col-sm-6 col-lg-6">
			<img class="img-responsive" src={{ '{{data.image_uri}}' }}></img>
		</div>
	</div>
	
	<div class="page-header">
		<h3>Ingredients</h3>
	</div>
	<div class="row">
		<div class="col-xs-12 col-sm-6 col-lg-4">
			<div class="checkbox">
				<label><input type="checkbox" value="">{{test_ingred | safe}}</label>
			</div>
			<div class="checkbox" ng-repeat="x in data.ingredients">
				<label><input type="checkbox" value=""><a ng-href="/ingredient_{{ '{{x.id}}' }}.html">{{ '{{x.original_string}}' }}</a></label>
			</div>
		</div>
		<div class="col-xs-12 col-sm-6 col-lg-4">
		</div>
	</div>
    
	<div class="page-header">
		<h3>Instructions</h3>
	</div>
	<div>
		<table class="table table-default">
		<tr ng-repeat="x in data.instructions">
			<td class="fit"><span class="glyphicon glyphicon-minus"></span></td>
			<td ng-class='{info:$first}'>{{ '{{x}}' }}</td>
		</tr>
		</table>
	</div>
</div>
{% endblock content %}
